{
  "name": "xFormers DevContainer",
  "build": {
    "dockerfile": "Dockerfile",
    "args": {
      "BUILDKIT_INLINE_CACHE": "1",
      "XFORMERS_FORK_URL": "https://github.com/<my-github-username>/xformers.git",
      "TORCH_CUDA_ARCH_LIST": "12.0"
    },
    "cacheFrom": ["alexchesser/xformers-devcontainer:latest"]
  },
  "remoteEnv": {
    // if you're planning on contributing, this should be updated to your FORK   
    "XFORMERS_FORK_URL": "https://github.com/<my-github-username>/xformers.git"
  },
  // The 'docker-in-docker' feature ensures that the build environment has access
  // to the GPU. This is necessary for the xformers compilation to succeed.
  "features": {
    "ghcr.io/devcontainers/features/docker-in-docker:2.1.0": {
      "enableNonRootDocker": "true",
      "moby": "true",
      "dockerDashGpu": "true"
    }
  },
  // This 'runArgs' property is still needed to give the container GPU access
  // after it has been built and is running.
  "runArgs": [ "--gpus", "all" ],
  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-toolsai.jupyter",
        "dbaeumer.vscode-eslint"
      ]
    }
  },
  "postCreateCommand": "./.devcontainer/post-create.sh",
  "remoteUser": "vscode"
}